# @axe-devtools/script-builder

This API allows the use of the axe Devtools accessibility checking and reporting API from a Node.js application. It works with npm through a custom registry built on the Artifactory application.

## Installation:

Set up your [custom registry](artifactory-setup.md). Note: if you cannot use an external registry, then please contact Deque systems for information on how to download the `.tgz` file for use with npm.

### Custom Rules

If you are using (or plan on using) custom rules, follow these instructions. Otherwise use a rulesetId when initializing the API (see below).

Download custom rules from the Deque registry and note the location on your file system. In the command below, replace `customer-id` with the ID for your organization, given to you by Deque Systems.

#### Local Installation

```
npm install @axe-devtools/script-builder
```

#### Global Installation

```
npm install -g @axe-devtools/script-builder
```

### No custom rules yet

If you do not have custom rules yet and wish to start with an empty custom ruleset. Create an `axe-ruleset.json` file in the local directory with an empty JavaScript object in it (`{}`).

### Install axe Devtools API and its dependencies:

```
npm install @axe-devtools/script-builder
```

## API

### Description

@axe-devtools-npm/script-builder is a Node.js module and can be required in your source code as follows:

```js
const scriptBuilder = require('@axe-devtools/script-builder');
```

### scriptBuilder.buildAxeDevtoolsSource([config])

Initializes axe Devtools using either a specific ruleset or a specific version of axe-core.

#### Parameters

`config` (**optional**): _One_ of the following:

- **Ruleset ID** (`String`): Valid values are `'wcag2'` for WCAG 2 level A and AA, `'wcag2.1` for WCAG 2.1 level A and AA, `'508'` for Section 508. _NOTE_: Use a ruleset id, only if you do not want to use custom rules. If you want to use custom rules, use the custom rule configuration described above.

- **axe** (`Object`): This version of axe will be used to perform your analysis.

- **rulesetFile** (`String`): Path to your `axe-ruleset.json` file

#### Returns

An `AxeDevtoolsAPI` object.

### AxeDevtoolsAPI

The object returned by the `scriptBuilder.buildAxeDevtoolsSource()` function has the following properties:

```json
{
  "source": "String of the entire axe Devtools source code that can be used for injecting into remote browsers",
  "standards": ["Array of standard configuration definitions"]
}
```

#### AxeDevtoolsAPI#source

This is a string that is the entire source code of the axe Devtools library plus the configuration that has been chosen by the ruleSetID OR the custom rules configuration. This is useful for sending to a remote browser through a system like Selenium's `ExecuteScript` or `ExecuteAsyncScript` calls, or Puppeteer's `Page.evaluate()`.

#### AxeDevtoolsAPI#standards

This is an Array of objects with the following structure:

```
{
	id: String ID of the configuration
	defn: Object with the configuration
}
```

Currently valid IDs are `'wcag2'`, `'wcag21'`, and `'508'`.

## Example

There is an example of how to use the axe Devtools Script Builder API and the reporting API in conjunction with the open source version of axe-webdriverjs in the [docs/examples](docs/examples/readme.md) directory.
